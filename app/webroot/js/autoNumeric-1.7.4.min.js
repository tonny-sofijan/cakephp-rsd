(function(a){function b(a){var b={};if(a.selectionStart===undefined){a.focus();var c=document.selection.createRange();b.length=c.text.length;c.moveStart("character",-a.value.length);b.end=c.text.length;b.start=b.end-b.length}else{b.start=a.selectionStart;b.end=a.selectionEnd;b.length=b.end-b.start}return b}function c(a,b,c){if(a.selectionStart===undefined){a.focus();var d=a.createTextRange();d.collapse(true);d.moveEnd("character",c);d.moveStart("character",b);d.select()}else{a.selectionStart=b;a.selectionEnd=c}}function d(b,c){a.each(c,function(d,e){if(typeof e==="function"){c[d]=e(b,c,d)}else if(typeof e==="string"){var f=e.substr(0,4);if(f==="fun:"){var g=a.autoNumeric[e.substr(4)];if(typeof g==="function"){c[d]=a.autoNumeric[e.substr(4)](b,c,d)}else{c[d]=null}}else if(f==="css:"){c[d]=a(e.substr(4)).val()}}})}function e(a,b){if(typeof a[b]==="string"){a[b]*=1}}function f(b,c){var f=a.extend({},a.fn.autoNumeric.defaults,c);if(a.metadata){f=a.extend(f,b.metadata())}d(b,f);var g=f.vMax.toString().split(".");var h=!f.vMin&&f.vMin!==0?[]:f.vMin.toString().split(".");e(f,"vMax");e(f,"vMin");e(f,"mDec");f.aNeg=f.vMin<0?"-":"";if(typeof f.mDec!=="number"){f.mDec=Math.max((g[1]?g[1]:"").length,(h[1]?h[1]:"").length)}if(f.altDec===null&&f.mDec>0){if(f.aDec==="."&&f.aSep!==","){f.altDec=","}else if(f.aDec===","&&f.aSep!=="."){f.altDec="."}}var i=f.aNeg?"([-\\"+f.aNeg+"]?)":"(-?)";f._aNegReg=i;f._skipFirst=new RegExp(i+"[^-"+(f.aNeg?"\\"+f.aNeg:"")+"\\"+f.aDec+"\\d]"+".*?(\\d|\\"+f.aDec+"\\d)");f._skipLast=new RegExp("(\\d\\"+f.aDec+"?)[^\\"+f.aDec+"\\d]\\D*$");var j=(f.aNeg?f.aNeg:"-")+f.aNum+"\\"+f.aDec;if(f.altDec&&f.altDec!==f.aSep){j+=f.altDec}f._allowed=new RegExp("[^"+j+"]","gi");f._numReg=new RegExp(i+"(?:\\"+f.aDec+"?(\\d+\\"+f.aDec+"\\d+)|(\\d*(?:\\"+f.aDec+"\\d*)?))");return f}function g(a,b,c){if(b.aSign){while(a.indexOf(b.aSign)>-1){a=a.replace(b.aSign,"")}}a=a.replace(b._skipFirst,"$1$2");a=a.replace(b._skipLast,"$1");a=a.replace(b._allowed,"");if(b.altDec){a=a.replace(b.altDec,b.aDec)}var d=a.match(b._numReg);a=d?[d[1],d[2],d[3]].join(""):"";if(c){var e="^"+b._aNegReg+"0*(\\d"+(c==="leading"?")":"|$)");e=new RegExp(e);a=a.replace(e,"$1$2")}return a}function h(a,b,c){if(b&&c){var d=a.split(b);if(d[1]&&d[1].length>c){if(c>0){d[1]=d[1].substring(0,c);a=d.join(b)}else{a=d[0]}}}return a}function i(a,b,c){if(b&&b!=="."){a=a.replace(b,".")}if(c&&c!=="-"){a=a.replace(c,"-")}if(!a.match(/\d/)){a+="0"}return a}function j(a,b,c){if(c&&c!=="-"){a=a.replace("-",c)}if(b&&b!=="."){a=a.replace(".",b)}return a}function k(a,b){a=g(a,b);a=h(a,b.aDec,b.mDec);a=i(a,b.aDec,b.aNeg);var c=+a;return c>=b.vMin&&c<=b.vMax}function l(a,b,c){if(a===""||a===b.aNeg){if(b.wEmpty==="zero"){return a+"0"}else if(b.wEmpty==="sign"||c){return a+b.aSign}else{return a}}return null}function m(a,b){a=g(a,b);var c=l(a,b,true);if(c!==null){return c}var d="";if(b.dGroup===2){d=/(\d)((\d)(\d{2}?)+)$/}else if(b.dGroup===4){d=/(\d)((\d{4}?)+)$/}else{d=/(\d)((\d{3}?)+)$/}var e=a.split(b.aDec);if(b.altDec&&e.length===1){e=a.split(b.altDec)}var f=e[0];if(b.aSep){while(d.test(f)){f=f.replace(d,"$1"+b.aSep+"$2")}}if(b.mDec!==0&&e.length>1){if(e[1].length>b.mDec){e[1]=e[1].substring(0,b.mDec)}a=f+b.aDec+e[1]}else{a=f}if(b.aSign){var h=a.indexOf(b.aNeg)!==-1;a=a.replace(b.aNeg,"");a=b.pSign==="p"?b.aSign+a:a+b.aSign;if(h){a=b.aNeg+a}}return a}function n(a,b,c,d){a=a===""?"0":a.toString();var e="";var f=0;var g="";var h=typeof d==="boolean"||d===null?d?b:0:+d;var i=function(a){var b=h===0?/(\.[1-9]*)0*$/:h===1?/(\.\d[1-9]*)0*$/:new RegExp("(\\.\\d{"+h+"}[1-9]*)0*$");a=a.replace(b,"$1");if(h===0){a=a.replace(/\.$/,"")}return a};if(a.charAt(0)==="-"){g="-";a=a.replace("-","")}if(!a.match(/^\d/)){a="0"+a}if(g==="-"&&+a===0){g=""}if(+a>0){a=a.replace(/^0*(\d)/,"$1")}var j=a.lastIndexOf(".");var k=j===-1?a.length-1:j;var l=a.length-1-k;if(l<=b){e=a;if(l<h){if(j===-1){e+="."}while(l<h){var m="000000".substring(0,h-l);e+=m;l+=m.length}}else if(l>h){e=i(e)}else if(l===0&&h===0){e=e.replace(/\.$/,"")}return g+e}var n=j+b;var o=+a.charAt(n+1);var p=a.substring(0,n+1).split("");var q=a.charAt(n)==="."?a.charAt(n-1)%2:a.charAt(n)%2;if(o>4&&c==="S"||o>4&&c==="A"&&g===""||o>5&&c==="A"&&g==="-"||o>5&&c==="s"||o>5&&c==="a"&&g===""||o>4&&c==="a"&&g==="-"||o>5&&c==="B"||o===5&&c==="B"&&q===1||o>0&&c==="C"&&g===""||o>0&&c==="F"&&g==="-"||o>0&&c==="U"){for(f=p.length-1;f>=0;f-=1){if(p[f]!=="."){p[f]=+p[f]+1;if(p[f]<10){break}else if(f>0){p[f]="0"}}}}p=p.slice(0,n+1);e=i(p.join(""));return g+e}function o(b,c){this.options=c;this.that=b;this.$that=a(b);this.formatted=false;this.io=f(this.$that,this.options);this.value=b.value}function p(a){var b=a.data("autoNumeric");if(!b){b={};a.data("autoNumeric",b)}return b}function q(a,b){var c=p(a);var d=c.holder;if(d===undefined&&b){d=new o(a.get(0),b);c.holder=d}return d}function r(a){var b=a.data("autoNumeric");if(b&&b.holder){return b.holder.options}return{}}function s(b){b=b||{};var c=a(this),d=q(c,b);if(d.io.aForm&&(this.value||d.io.wEmpty!=="empty")){c.autoNumericSet(c.autoNumericGet(b),b)}}function t(b){var c=a(b.target),d=q(c);d.init(b);if(d.skipAllways(b)){d.processed=true;return true}if(d.processAllways()){d.processed=true;d.formatQuick();b.preventDefault();return false}else{d.formatted=false}return true}function u(b){var c=a(b.target),d=q(c);var e=d.processed;d.init(b);if(d.skipAllways(b)){return true}if(e){b.preventDefault();return false}if(d.processAllways()||d.processKeypress()){d.formatQuick();b.preventDefault();return false}else{d.formatted=false}}function v(b){var c=a(b.target),d=q(c);d.init(b);var e=d.skipAllways(b);d.kdCode=0;delete d.valuePartsBeforePaste;if(e){return true}if(this.value===""){return true}if(!d.formatted){d.formatQuick()}}function w(b){var c=a(b.target),d=q(c);d.inVal=c.val();var e=l(d.inVal,d.io,true);if(e!==null){c.val(e)}}function x(b){var c=a(b.target),d=q(c);var e=d.io,f=c.val(),h=f;if(f!==""){f=g(f,e);if(l(f,e)===null&&k(f,e)){f=i(f,e.aDec,e.aNeg);f=n(f,e.mDec,e.mRound,e.aPad);f=j(f,e.aDec,e.aNeg)}else{f=""}}var o=l(f,e,false);if(o===null){o=m(f,e)}if(o!==h){c.val(o)}if(o!==d.inVal){c.change();delete d.inVal}}function y(b){if(typeof b==="string"){b=b.replace(/\[/g,"\\[").replace(/\]/g,"\\]");b="#"+b.replace(/(:|\.)/g,"\\$1")}return a(b)}o.prototype={init:function(a){this.value=this.that.value;this.io=f(this.$that,this.options);this.cmdKey=a.metaKey;this.shiftKey=a.shiftKey;this.selection=b(this.that);if(a.type==="keydown"||a.type==="keyup"){this.kdCode=a.keyCode}this.which=a.which;this.processed=false;this.formatted=false},setSelection:function(a,b,d){a=Math.max(a,0);b=Math.min(b,this.that.value.length);this.selection={start:a,end:b,length:b-a};if(d===undefined||d){c(this.that,a,b)}},setPosition:function(a,b){this.setSelection(a,a,b)},getBeforeAfter:function(){var a=this.value;var b=a.substring(0,this.selection.start);var c=a.substring(this.selection.end,a.length);return[b,c]},getBeforeAfterStriped:function(){var a=this.getBeforeAfter();a[0]=g(a[0],this.io);a[1]=g(a[1],this.io);return a},normalizeParts:function(a,b){var c=this.io;b=g(b,c);var d=b.match(/^\d/)?true:"leading";a=g(a,c,d);if(a===""||a===c.aNeg){if(b>""){b=b.replace(/^0*(\d)/,"$1")}}var e=a+b;if(c.aDec){var f=e.match(new RegExp("^"+c._aNegReg+"\\"+c.aDec));if(f){a=a.replace(f[1],f[1]+"0");e=a+b}}if(c.wEmpty==="zero"&&(e===c.aNeg||e==="")){a+="0"}return[a,b]},setValueParts:function(a,b){var c=this.io;var d=this.normalizeParts(a,b);var e=d.join("");var f=d[0].length;if(k(e,c)){e=h(e,c.aDec,c.mDec);if(f>e.length){f=e.length}this.value=e;this.setPosition(f,false);return true}return false},signPosition:function(){var a=this.io,b=a.aSign,c=this.that;if(b){var d=b.length;if(a.pSign==="p"){var e=a.aNeg&&c.value&&c.value.charAt(0)===a.aNeg;return e?[1,d+1]:[0,d]}else{var f=c.value.length;return[f-d,f]}}else{return[1e3,-1]}},expandSelectionOnSign:function(a){var b=this.signPosition();var c=this.selection;if(c.start<b[1]&&c.end>b[0]){if((c.start<b[0]||c.end>b[1])&&this.value.substring(Math.max(c.start,b[0]),Math.min(c.end,b[1])).match(/^\s*$/)){if(c.start<b[0]){this.setSelection(c.start,b[0],a)}else{this.setSelection(b[1],c.end,a)}}else{this.setSelection(Math.min(c.start,b[0]),Math.max(c.end,b[1]),a)}}},checkPaste:function(){if(this.valuePartsBeforePaste!==undefined){var a=this.getBeforeAfter();var b=this.valuePartsBeforePaste;delete this.valuePartsBeforePaste;a[0]=a[0].substr(0,b[0].length)+g(a[0].substr(b[0].length),this.io);if(!this.setValueParts(a[0],a[1])){this.value=b.join("");this.setPosition(b[0].length,false)}}},skipAllways:function(a){var b=this.kdCode,c=this.which,d=this.cmdKey;if(b===17&&a.type==="keyup"&&this.valuePartsBeforePaste!==undefined){this.checkPaste();return false}if(b>=112&&b<=123||b>=91&&b<=93||b>=9&&b<=31||b<8&&(c===0||c===b)||b===144||b===145||b===45){return true}if(d&&b===65){return true}if(d&&(b===67||b===86||b===88)){if(a.type==="keydown"){this.expandSelectionOnSign()}if(b===86){if(a.type==="keydown"||a.type==="keypress"){if(this.valuePartsBeforePaste===undefined){this.valuePartsBeforePaste=this.getBeforeAfter()}}else{this.checkPaste()}}return a.type==="keydown"||a.type==="keypress"||b===67}if(d){return true}if(b===37||b===39){var e=this.io.aSep,f=this.selection.start,g=this.that.value;if(a.type==="keydown"&&e&&!this.shiftKey){if(b===37&&g.charAt(f-2)===e){this.setPosition(f-1)}else if(b===39&&g.charAt(f)===e){this.setPosition(f+1)}}return true}if(b>=34&&b<=40){return true}return false},processAllways:function(){var a;if(this.kdCode===8||this.kdCode===46){if(!this.selection.length){a=this.getBeforeAfterStriped();if(this.kdCode===8){a[0]=a[0].substring(0,a[0].length-1)}else{a[1]=a[1].substring(1,a[1].length)}this.setValueParts(a[0],a[1])}else{this.expandSelectionOnSign(false);a=this.getBeforeAfterStriped();this.setValueParts(a[0],a[1])}return true}return false},processKeypress:function(){var a=this.io;var b=String.fromCharCode(this.which);var c=this.getBeforeAfterStriped();var d=c[0],e=c[1];if(b===a.aDec||a.altDec&&b===a.altDec||(b==="."||b===",")&&this.kdCode===110){if(!a.mDec||!a.aDec){return true}if(a.aNeg&&e.indexOf(a.aNeg)>-1){return true}if(d.indexOf(a.aDec)>-1){return true}if(e.indexOf(a.aDec)>0){return true}if(e.indexOf(a.aDec)===0){e=e.substr(1)}this.setValueParts(d+a.aDec,e);return true}if(b==="-"||b==="+"){if(!a.aNeg){return true}if(d===""&&e.indexOf(a.aNeg)>-1){d=a.aNeg;e=e.substring(1,e.length)}if(d.charAt(0)===a.aNeg){d=d.substring(1,d.length)}else{d=b==="-"?a.aNeg+d:d}this.setValueParts(d,e);return true}if(b>="0"&&b<="9"){if(a.aNeg&&d===""&&e.indexOf(a.aNeg)>-1){d=a.aNeg;e=e.substring(1,e.length)}this.setValueParts(d+b,e);return true}return true},formatQuick:function(){var a=this.io;var b=this.getBeforeAfterStriped();var c=m(this.value,this.io);var d=c.length;if(c){var e=b[0].split("");var f;for(f=0;f<e.length;f+=1){if(!e[f].match("\\d")){e[f]="\\"+e[f]}}var g=new RegExp("^.*?"+e.join(".*?"));var h=c.match(g);if(h){d=h[0].length;if((d===0&&c.charAt(0)!==a.aNeg||d===1&&c.charAt(0)===a.aNeg)&&a.aSign&&a.pSign==="p"){d=this.io.aSign.length+(c.charAt(0)==="-"?1:0)}}else if(a.aSign&&a.pSign==="s"){d-=a.aSign.length}}this.that.value=c;this.setPosition(d);this.formatted=true}};a.fn.autoNumeric=function(a){return this.each(function(){s.call(this,a)}).unbind(".autoNumeric").bind({"keydown.autoNumeric":t,"keypress.autoNumeric":u,"keyup.autoNumeric":v,"focusin.autoNumeric":w,"focusout.autoNumeric":x})};a.autoNumeric={};a.autoNumeric.Strip=function(b){var c=y(b);var d=r(c);if(arguments[1]&&typeof arguments[1]==="object"){d=a.extend({},d,arguments[1])}var e=f(c,d);var h=y(b).val();h=g(h,e);h=i(h,e.aDec,e.aNeg);if(+h===0){h="0"}return h};a.autoNumeric.Format=function(b,c){var d=y(b);var e=r(d);if(arguments[2]&&typeof arguments[2]==="object"){e=a.extend({},e,arguments[2])}c.toString();var g=f(d,e);c=n(c,g.mDec,g.mRound,g.aPad);c=j(c,g.aDec,g.aNeg);if(!k(c,g)){c=n("",g.mDec,g.mRound,g.aPad)}return m(c,g)};a.fn.autoNumericGet=function(){if(arguments[0]){return a.autoNumeric.Strip(this,arguments[0])}return a.autoNumeric.Strip(this)};a.fn.autoNumericSet=function(b){if(arguments[1]){return this.val(a.autoNumeric.Format(this,b,arguments[1]))}return this.val(a.fn.autoNumeric.Format(this,b))};a.autoNumeric.defaults={aNum:"0123456789",aSep:",",dGroup:"3",aDec:".",altDec:null,aSign:"",pSign:"p",vMax:"999999999.99",vMin:"0.00",mDec:null,mRound:"S",aPad:true,wEmpty:"empty",aForm:false};a.fn.autoNumeric.defaults=a.autoNumeric.defaults;a.fn.autoNumeric.Strip=a.autoNumeric.Strip;a.fn.autoNumeric.Format=a.autoNumeric.Format})(jQuery)